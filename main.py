import os

import clickhouse_connect
import time

from load_env_file import load_env_file
from sources.ChdbSource import ChdbSource
from sources.ClickhouseRemoteSource import ClickhouseRemoteSource
from sources.ParquetSource import ParquetSource

load_env_file()
start_time = time.perf_counter()

client = clickhouse_connect.get_client(
    host=os.getenv("CLICKHOUSE_HOST"),
    port=int(os.getenv("CLICKHOUSE_PORT")),
    user=os.getenv("CLICKHOUSE_USERNAME"),
    password=os.getenv("CLICKHOUSE_PASSWORD"),
    database=os.getenv("CLICKHOUSE_DATABASE"),
)

# clickhouseClient = ClickhouseRemoteSource(client)
#
# clickhouseClient.read_clickhouse_db()


# chdb_client = ChdbSource("string_storage")
# chdb_client.create_table()
# chdb_client.write_string()
# chdb_client.read_table()
# chdb_client.select_one_test()

parquet_source = ParquetSource("./parquet_data/events.parquet")
parquet_source.read_parquet()
# pycharm-python-interpreter  | [{'event_app': 'comzillionwhaleswildwars', 'event': 'game_loading_error', 'event_date': datetime.date(2014, 12, 10), 'event_time': datetime.datetime(2014, 12, 10, 5, 11, 36), 'event_id': 402752555, 'string_00': 'EntrypointUnreachable', 'string_01': 'Network login failed', 'string_02': '', 'string_03': '', 'string_04': '', 'string_05': '', 'string_06': '', 'string_07': '', 'string_08': '', 'string_09': '', 'string_10': '', 'string_11': '', 'string_12': '', 'string_13': '', 'string_14': '', 'string_15': '', 'string_16': '', 'string_17': '', 'string_18': '', 'string_19': '', 'float_00': 0.0, 'float_01': 0.0, 'float_02': 0.0, 'float_03': 0.0, 'float_04': 0.0, 'float_05': 0.0, 'float_06': 0.0, 'float_07': 0.0, 'float_08': 0.0, 'float_09': 0.0, 'float_10': 0.0, 'float_11': 0.0, 'float_12': 0.0, 'float_13': 0.0, 'float_14': 0.0, 'float_15': 0.0, 'float_16': 0.0, 'float_17': 0.0, 'float_18': 0.0, 'float_19': 0.0, 'string_20': '', 'string_21': '', 'string_22': '', 'string_23': '', 'string_24': '', 'string_25': '', 'string_26': '', 'string_27': '', 'string_28': '', 'string_29': '', 'float_20': 0.0, 'float_21': 0.0, 'float_22': 0.0, 'float_23': 0.0, 'float_24': 0.0, 'float_25': 0.0, 'float_26': 0.0, 'float_27': 0.0, 'float_28': 0.0, 'float_29': 0.0, 'event_context': '', 'event_tick': 1744421031}, {'event_app': 'comzillionwhaleswildwars', 'event': 'game_loading_error', 'event_date': datetime.date(2014, 12, 10), 'event_time': datetime.datetime(2014, 12, 10, 5, 11, 41), 'event_id': 1951504110, 'string_00': 'EntrypointUnreachable', 'string_01': 'Network login failed', 'string_02': '', 'string_03': '', 'string_04': '', 'string_05': '', 'string_06': '', 'string_07': '', 'string_08': '', 'string_09': '', 'string_10': '', 'string_11': '', 'string_12': '', 'string_13': '', 'string_14': '', 'string_15': '', 'string_16': '', 'string_17': '', 'string_18': '', 'string_19': '', 'float_00': 0.0, 'float_01': 0.0, 'float_02': 0.0, 'float_03': 0.0, 'float_04': 0.0, 'float_05': 0.0, 'float_06': 0.0, 'float_07': 0.0, 'float_08': 0.0, 'float_09': 0.0, 'float_10': 0.0, 'float_11': 0.0, 'float_12': 0.0, 'float_13': 0.0, 'float_14': 0.0, 'float_15': 0.0, 'float_16': 0.0, 'float_17': 0.0, 'float_18': 0.0, 'float_19': 0.0, 'string_20': '', 'string_21': '', 'string_22': '', 'string_23': '', 'string_24': '', 'string_25': '', 'string_26': '', 'string_27': '', 'string_28': '', 'string_29': '', 'float_20': 0.0, 'float_21': 0.0, 'float_22': 0.0, 'float_23': 0.0, 'float_24': 0.0, 'float_25': 0.0, 'float_26': 0.0, 'float_27': 0.0, 'float_28': 0.0, 'float_29': 0.0, 'event_context': '', 'event_tick': 1744420999}, {'event_app': 'comzillionwhaleswildwars', 'event': 'pause', 'event_date': datetime.date(2014, 12, 10), 'event_time': datetime.datetime(2014, 12, 10, 5, 11, 42), 'event_id': 1594786331, 'string_00': '', 'string_01': '', 'string_02': '', 'string_03': '', 'string_04': '', 'string_05': '', 'string_06': '', 'string_07': '', 'string_08': '', 'string_09': '', 'string_10': '', 'string_11': '', 'string_12': '', 'string_13': '', 'string_14': '', 'string_15': '', 'string_16': '', 'string_17': '', 'string_18': '', 'string_19': '', 'float_00': 0.0, 'float_01': 0.0, 'float_02': 0.0, 'float_03': 0.0, 'float_04': 0.0, 'float_05': 0.0, 'float_06': 0.0, 'float_07': 0.0, 'float_08': 0.0, 'float_09': 0.0, 'float_10': 0.0, 'float_11': 0.0, 'float_12': 0.0, 'float_13': 0.0, 'float_14': 0.0, 'float_15': 0.0, 'float_16': 0.0, 'float_17': 0.0, 'float_18': 0.0, 'float_19': 0.0, 'string_20': '', 'string_21': '', 'string_22': '', 'string_23': '', 'string_24': '', 'string_25': '', 'string_26': '', 'string_27': '', 'string_28': '', 'string_29': '', 'float_20': 0.0, 'float_21': 0.0, 'float_22': 0.0, 'float_23': 0.0, 'float_24': 0.0, 'float_25': 0.0, 'float_26': 0.0, 'float_27': 0.0, 'float_28': 0.0, 'float_29': 0.0, 'event_context': '', 'event_tick': 1744420977}, {'event_app': 'comzillionwhaleswildwars', 'event': 'resume', 'event_date': datetime.date(2014, 12, 10), 'event_time': datetime.datetime(2014, 12, 10, 5, 11, 33), 'event_id': 1977289376, 'string_00': '', 'string_01': '', 'string_02': '', 'string_03': '', 'string_04': '', 'string_05': '', 'string_06': '', 'string_07': '', 'string_08': '', 'string_09': '', 'string_10': '', 'string_11': '', 'string_12': '', 'string_13': '', 'string_14': '', 'string_15': '', 'string_16': '', 'string_17': '', 'string_18': '', 'string_19': '', 'float_00': 0.0, 'float_01': 0.0, 'float_02': 0.0, 'float_03': 0.0, 'float_04': 0.0, 'float_05': 0.0, 'float_06': 0.0, 'float_07': 0.0, 'float_08': 0.0, 'float_09': 0.0, 'float_10': 0.0, 'float_11': 0.0, 'float_12': 0.0, 'float_13': 0.0, 'float_14': 0.0, 'float_15': 0.0, 'float_16': 0.0, 'float_17': 0.0, 'float_18': 0.0, 'float_19': 0.0, 'string_20': '', 'string_21': '', 'string_22': '', 'string_23': '', 'string_24': '', 'string_25': '', 'string_26': '', 'string_27': '', 'string_28': '', 'string_29': '', 'float_20': 0.0, 'float_21': 0.0, 'float_22': 0.0, 'float_23': 0.0, 'float_24': 0.0, 'float_25': 0.0, 'float_26': 0.0, 'float_27': 0.0, 'float_28': 0.0, 'float_29': 0.0, 'event_context': '', 'event_tick': 1744421040}, {'event_app': 'comzillionwhaleswildwars', 'event': 'test_idfa_start', 'event_date': datetime.date(2014, 12, 10), 'event_time': datetime.datetime(2014, 12, 10, 5, 11, 33), 'event_id': 1552201649, 'string_00': '', 'string_01': '', 'string_02': '', 'string_03': '', 'string_04': '', 'string_05': '', 'string_06': '', 'string_07': '', 'string_08': '', 'string_09': '', 'string_10': '', 'string_11': '', 'string_12': '', 'string_13': '', 'string_14': '', 'string_15': '', 'string_16': '', 'string_17': '', 'string_18': '', 'string_19': '', 'float_00': 0.0, 'float_01': 0.0, 'float_02': 0.0, 'float_03': 0.0, 'float_04': 0.0, 'float_05': 0.0, 'float_06': 0.0, 'float_07': 0.0, 'float_08': 0.0, 'float_09': 0.0, 'float_10': 0.0, 'float_11': 0.0, 'float_12': 0.0, 'float_13': 0.0, 'float_14': 0.0, 'float_15': 0.0, 'float_16': 0.0, 'float_17': 0.0, 'float_18': 0.0, 'float_19': 0.0, 'string_20': '', 'string_21': '', 'string_22': '', 'string_23': '', 'string_24': '', 'string_25': '', 'string_26': '', 'string_27': '', 'string_28': '', 'string_29': '', 'float_20': 0.0, 'float_21': 0.0, 'float_22': 0.0, 'float_23': 0.0, 'float_24': 0.0, 'float_25': 0.0, 'float_26': 0.0, 'float_27': 0.0, 'float_28': 0.0, 'float_29': 0.0, 'event_context': '', 'event_tick': 1744421040}, {'event_app': 'comzillionwhaleswildwars', 'event': 'game_loading_error', 'event_date': datetime.date(2016, 1, 2), 'event_time': datetime.datetime(2016, 1, 2, 3, 15, 36), 'event_id': 1422557434, 'string_00': 'EntrypointUnreachable', 'string_01': 'Network login failed', 'string_02': '', 'string_03': '', 'string_04': '', 'string_05': '', 'string_06': '', 'string_07': '', 'string_08': '', 'string_09': '', 'string_10': '', 'string_11': '', 'string_12': '', 'string_13': '', 'string_14': '', 'string_15': '', 'string_16': '', 'string_17': '', 'string_18': '', 'string_19': '', 'float_00': 0.0, 'float_01': 0.0, 'float_02': 0.0, 'float_03': 0.0, 'float_04': 0.0, 'float_05': 0.0, 'float_06': 0.0, 'float_07': 0.0, 'float_08': 0.0, 'float_09': 0.0, 'float_10': 0.0, 'float_11': 0.0, 'float_12': 0.0, 'float_13': 0.0, 'float_14': 0.0, 'float_15': 0.0, 'float_16': 0.0, 'float_17': 0.0, 'float_18': 0.0, 'float_19': 0.0, 'string_20': '', 'string_21': '', 'string_22': '', 'string_23': '', 'string_24': '', 'string_25': '', 'string_26': '', 'string_27': '', 'string_28': '', 'string_29': '', 'float_20': 0.0, 'float_21': 0.0, 'float_22': 0.0, 'float_23': 0.0, 'float_24': 0.0, 'float_25': 0.0, 'float_26': 0.0, 'float_27': 0.0, 'float_28': 0.0, 'float_29': 0.0, 'event_context': '', 'event_tick': 1744430684}, {'event_app': 'comzillionwhaleswildwars', 'event': 'game_loading_error', 'event_date': datetime.date(2016, 1, 2), 'event_time': datetime.datetime(2016, 1, 2, 3, 15, 43), 'event_id': 1834530508, 'string_00': 'EntrypointUnreachable', 'string_01': 'Network login failed', 'string_02': '', 'string_03': '', 'string_04': '', 'string_05': '', 'string_06': '', 'string_07': '', 'string_08': '', 'string_09': '', 'string_10': '', 'string_11': '', 'string_12': '', 'string_13': '', 'string_14': '', 'string_15': '', 'string_16': '', 'string_17': '', 'string_18': '', 'string_19': '', 'float_00': 0.0, 'float_01': 0.0, 'float_02': 0.0, 'float_03': 0.0, 'float_04': 0.0, 'float_05': 0.0, 'float_06': 0.0, 'float_07': 0.0, 'float_08': 0.0, 'float_09': 0.0, 'float_10': 0.0, 'float_11': 0.0, 'float_12': 0.0, 'float_13': 0.0, 'float_14': 0.0, 'float_15': 0.0, 'float_16': 0.0, 'float_17': 0.0, 'float_18': 0.0, 'float_19': 0.0, 'string_20': '', 'string_21': '', 'string_22': '', 'string_23': '', 'string_24': '', 'string_25': '', 'string_26': '', 'string_27': '', 'string_28': '', 'string_29': '', 'float_20': 0.0, 'float_21': 0.0, 'float_22': 0.0, 'float_23': 0.0, 'float_24': 0.0, 'float_25': 0.0, 'float_26': 0.0, 'float_27': 0.0, 'float_28': 0.0, 'float_29': 0.0, 'event_context': '', 'event_tick': 1744430718}, {'event_app': 'comzillionwhaleswildwars', 'event': 'pause', 'event_date': datetime.date(2016, 1, 2), 'event_time': datetime.datetime(2016, 1, 2, 3, 15, 47), 'event_id': 957851700, 'string_00': '', 'string_01': '', 'string_02': '', 'string_03': '', 'string_04': '', 'string_05': '', 'string_06': '', 'string_07': '', 'string_08': '', 'string_09': '', 'string_10': '', 'string_11': '', 'string_12': '', 'string_13': '', 'string_14': '', 'string_15': '', 'string_16': '', 'string_17': '', 'string_18': '', 'string_19': '', 'float_00': 0.0, 'float_01': 0.0, 'float_02': 0.0, 'float_03': 0.0, 'float_04': 0.0, 'float_05': 0.0, 'float_06': 0.0, 'float_07': 0.0, 'float_08': 0.0, 'float_09': 0.0, 'float_10': 0.0, 'float_11': 0.0, 'float_12': 0.0, 'float_13': 0.0, 'float_14': 0.0, 'float_15': 0.0, 'float_16': 0.0, 'float_17': 0.0, 'float_18': 0.0, 'float_19': 0.0, 'string_20': '', 'string_21': '', 'string_22': '', 'string_23': '', 'string_24': '', 'string_25': '', 'string_26': '', 'string_27': '', 'string_28': '', 'string_29': '', 'float_20': 0.0, 'float_21': 0.0, 'float_22': 0.0, 'float_23': 0.0, 'float_24': 0.0, 'float_25': 0.0, 'float_26': 0.0, 'float_27': 0.0, 'float_28': 0.0, 'float_29': 0.0, 'event_context': '', 'event_tick': 1744430707}, {'event_app': 'comzillionwhaleswildwars', 'event': 'resume', 'event_date': datetime.date(2016, 1, 2), 'event_time': datetime.datetime(2016, 1, 2, 3, 15, 30), 'event_id': 1428736906, 'string_00': '', 'string_01': '', 'string_02': '', 'string_03': '', 'string_04': '', 'string_05': '', 'string_06': '', 'string_07': '', 'string_08': '', 'string_09': '', 'string_10': '', 'string_11': '', 'string_12': '', 'string_13': '', 'string_14': '', 'string_15': '', 'string_16': '', 'string_17': '', 'string_18': '', 'string_19': '', 'float_00': 0.0, 'float_01': 0.0, 'float_02': 0.0, 'float_03': 0.0, 'float_04': 0.0, 'float_05': 0.0, 'float_06': 0.0, 'float_07': 0.0, 'float_08': 0.0, 'float_09': 0.0, 'float_10': 0.0, 'float_11': 0.0, 'float_12': 0.0, 'float_13': 0.0, 'float_14': 0.0, 'float_15': 0.0, 'float_16': 0.0, 'float_17': 0.0, 'float_18': 0.0, 'float_19': 0.0, 'string_20': '', 'string_21': '', 'string_22': '', 'string_23': '', 'string_24': '', 'string_25': '', 'string_26': '', 'string_27': '', 'string_28': '', 'string_29': '', 'float_20': 0.0, 'float_21': 0.0, 'float_22': 0.0, 'float_23': 0.0, 'float_24': 0.0, 'float_25': 0.0, 'float_26': 0.0, 'float_27': 0.0, 'float_28': 0.0, 'float_29': 0.0, 'event_context': '', 'event_tick': 1744430698}, {'event_app': 'comzillionwhaleswildwars', 'event': 'test_idfa_start', 'event_date': datetime.date(2016, 1, 2), 'event_time': datetime.datetime(2016, 1, 2, 3, 15, 31), 'event_id': 148329772, 'string_00': '', 'string_01': '', 'string_02': '', 'string_03': '', 'string_04': '', 'string_05': '', 'string_06': '', 'string_07': '', 'string_08': '', 'string_09': '', 'string_10': '', 'string_11': '', 'string_12': '', 'string_13': '', 'string_14': '', 'string_15': '', 'string_16': '', 'string_17': '', 'string_18': '', 'string_19': '', 'float_00': 0.0, 'float_01': 0.0, 'float_02': 0.0, 'float_03': 0.0, 'float_04': 0.0, 'float_05': 0.0, 'float_06': 0.0, 'float_07': 0.0, 'float_08': 0.0, 'float_09': 0.0, 'float_10': 0.0, 'float_11': 0.0, 'float_12': 0.0, 'float_13': 0.0, 'float_14': 0.0, 'float_15': 0.0, 'float_16': 0.0, 'float_17': 0.0, 'float_18': 0.0, 'float_19': 0.0, 'string_20': '', 'string_21': '', 'string_22': '', 'string_23': '', 'string_24': '', 'string_25': '', 'string_26': '', 'string_27': '', 'string_28': '', 'string_29': '', 'float_20': 0.0, 'float_21': 0.0, 'float_22': 0.0, 'float_23': 0.0, 'float_24': 0.0, 'float_25': 0.0, 'float_26': 0.0, 'float_27': 0.0, 'float_28': 0.0, 'float_29': 0.0, 'event_context': '', 'event_tick': 1744430698}]

client.close()

# df = pd.read_parquet("events.parquet")
# print(df.head())

# c95bae4f44030f716a6854f1060d54a4405d5bb059736dddc9260bcd20a82779


end_time = time.perf_counter()
execution_time_ms = (end_time - start_time) * 1000
print(execution_time_ms)
